#!/bin/bash
# This subroutine expands velocity models delta_x/x in spherical harmonics

# Base directory
#base_dir="/media/will/WS/adiabat/"
#base_dir="/media/will/WS/"
base_dir="/media/will/Monika/overtone_preds/"


# List of directories to process
dirs=(
#"106_scale----conv//"
# "107_scale----conv/"
# "108_scale----conv/"
# "256_044_3800_lith_scl----conv/"
# "256_044_3800_lith_scl_1----conv/"
# "256_044_4000_1----conv/"
# "BB000----conv/"
# "BB022----conv/"
# "BB033----conv/"
# "BB044----conv/"
# "BB055--ceb--conv/"
# "BB055--crust--conv/"
# "BB055--fsp--conv/"
# "BB066--ceb--conv/"
# "BB066--crust--conv/"
# "BB066--fsp--conv/"
# "BB066_tvisc----conv/"
# "BB088--ceb--conv/"
# "BB088--crust--conv/"
# "BB088--fsp--conv/"
# "CC----conv/"
# "CC_highT----conv/"
# "CC_highT_prim--ceb--conv/"
# "CC_highT_prim--crust--conv/"
# "CC_highT_prim--fsp--conv/"
# "CC_lowT----conv/"
# "CC_lowT_prim--ceb--conv/"
# "CC_lowT_prim--crust--conv/"
# "CC_lowT_prim--fsp--conv/"
# "CC_prim--ceb--conv/"
# "CC_prim--crust--conv/"
# "CC_prim--fsp--conv/"
# "CMB2600----conv/"
# "CMB2600_2----conv/"
# "CMB2600_2_prim--ceb--conv/"
# "CMB2600_2_prim--crust--conv/"
# "CMB2600_2_prim--fsp--conv/"
# "CMB2600_2_prim_tvisc--ceb--conv/"
# "CMB2600_2_prim_tvisc--crust--conv/"
# "CMB2600_2_prim_tvisc--fsp--conv/"
# "CMB2600_2_tvisc----conv/"
# "CMB2600_scale----conv/"
# "CMB2800----conv/"
# "CMB2800_2----conv/"
# "CMB2800_2_prim--ceb--conv/"
# "CMB2800_2_prim--crust--conv/"
# "CMB2800_2_prim--fsp--conv/"
# "CMB2800_2_prim_tvisc--ceb--conv/"
# "CMB2800_2_prim_tvisc--crust--conv/"
# "CMB2800_2_prim_tvisc--fsp--conv/"
# "CMB2800_2_tvisc----conv/"
# "CMB2800_scale----conv/"
# "CMB3000----conv/"
# "CMB3000_2----conv/"
# "CMB3000_2_prim--ceb--conv/"
# "CMB3000_2_prim--crust--conv/"
# "CMB3000_2_prim--fsp--conv/"
# "CMB3000_2_prim_tvisc--ceb--conv/"
# "CMB3000_2_prim_tvisc--crust--conv/"
# "CMB3000_2_prim_tvisc--fsp--conv/"
# "CMB3000_2_tvisc----conv/"
# "CMB3000_scale----conv/"
# "CMB3200----conv/"
# "CMB3200_scale----conv/"
# "CMB3400----conv/"
# "CMB3400_scale----conv/"
# "CMB3600M----conv/"
# "CMB3800M----conv/"
# "CMB4000M----conv/"
# "compressible_400----conv/"
# "icond005----conv/"
# "icond009----conv/"
# "incompressible_400----conv/"
# "m_022_tv1_prim_u--ceb--conv/"
# "m_022_tv1_prim_u--crust--conv/"
# "m_022_tv1_prim_u--fsp--conv/"
# "m_022_tv1_u----conv/"
# "m_044_tv1_prim_u--ceb--conv/"
# "m_044_tv1_prim_u--crust--conv/"
# "m_044_tv1_prim_u--fsp--conv/"
# "m_044_tv1_u----conv/"
# "m_066_tv1_prim_u--ceb--conv/"
# "m_066_tv1_prim_u--crust--conv/"
# "m_066_tv1_prim_u--fsp--conv/"
# "m_066_tv1_u----conv/"
# "m_bas----conv/"
# "m_bb_000----conv/"
# "m_bb_000_tvisc----conv/"
# "m_bb_022----conv/"
# "m_bb_022_tvisc----conv/"
# "m_bb_022_tvisc1----conv/"
# "m_bb_022_tvisc1_prim--ceb--conv/"
# "m_bb_022_tvisc1_prim--crust--conv/"
# "m_bb_022_tvisc1_prim--fsp--conv/"
# "m_bb_044----conv/"
# "m_bb_044_tvisc----conv/"
# "m_bb_044_tvisc1----conv/"
# "m_bb_044_tvisc1_prim--ceb--conv/"
# "m_bb_044_tvisc1_prim--crust--conv/"
# "m_bb_044_tvisc1_prim--fsp--conv/"
# "m_bb_066----conv/"
# "m_bb_066_tvisc----conv/"
# "m_bb_066_tvisc1----conv/"
# "m_bb_066_tvisc1_comp----conv/"
# "m_bb_066_tvisc1_comp38----conv/"
# "m_bb_066_tvisc1_prim--ceb--conv/"
# "m_bb_066_tvisc1_prim--crust--conv/"
# "m_bb_066_tvisc1_prim--fsp--conv/"
# "m_bb_066_tvisc1_prim_comp--ceb--conv/"
# "m_bb_066_tvisc1_prim_comp--crust--conv/"
# "m_bb_066_tvisc1_prim_comp--fsp--conv/"
# "m_bb_066_tvisc1_prim_comp38--ceb--conv/"
# "m_bb_066_tvisc1_prim_comp38--crust--conv/"
# "m_bb_066_tvisc1_prim_comp38--fsp--conv/"
# "m_bb_088----conv/"
# "m_bb_088_tvisc----conv/"
# "m_cc----conv/"
# "m_cc_022_u----conv/"
# "m_cc_022_u_prim--ceb--conv/"
# "m_cc_022_u_prim--crust--conv/"
# "m_cc_022_u_prim--fsp--conv/"
# "m_cc_044_u----conv/"
# "m_cc_044_u_prim--ceb--conv/"
# "m_cc_044_u_prim--crust--conv/"
# "m_cc_044_u_prim--fsp--conv/"
# "m_cc_066_u----conv/"
# "m_cc_066_u_prim--ceb--conv/"
# "m_cc_066_u_prim--crust--conv/"
# "m_cc_066_u_prim--fsp--conv/"
# "m_cc_hi----conv/"
# "m_cc_hi_prim--ceb--conv/"
# "m_cc_hi_prim--crust--conv/"
# "m_cc_hi_prim--fsp--conv/"
# "m_cc_lo----conv/"
# "m_cc_lo_prim--ceb--conv/"
# "m_cc_lo_prim--crust--conv/"
# "m_cc_lo_prim--fsp--conv/"
# "m_cc_prim--ceb--conv/"
# "m_cc_prim--crust--conv/"
# "m_cc_prim--fsp--conv/"
#-------------------------------------
# "m_comp1----conv/"
# "m_jump_10----conv/"
# "m_jump_20----conv/"
# "m_lhz----conv/"
# "m_precond_100----conv/"
# "m_precond_100_rr----conv/"
# "m_precond_50----conv/"
# "m_thermal_het----conv/"
# "m_thermal_hom----conv/"
# "m_visc1----conv/"
# "m_visc1_tvisc----conv/"
# "m_visc2----conv/"
# "m_visc2_tvisc----conv/"
# "m_visc3----conv/"
# "m_visc3_tvisc----conv/"
# "m_visc4----conv/"
# "m_visc4_tvisc----conv/"
# "m_viscav_10----conv/"
# "m_viscav_2----conv/"
# "mcmb_2600_prim_u--ceb--conv/"
# "mcmb_2600_prim_u--crust--conv/"
# "mcmb_2600_prim_u--fsp--conv/"
# "mcmb_2600_u----conv/"
# "mcmb_2800_prim_u--ceb--conv/"
# "mcmb_2800_prim_u--crust--conv/"
# "mcmb_2800_prim_u--fsp--conv/"
# "mcmb_2800_u----conv/"
# "mcmb_3000_prim_u--ceb--conv/"
# "mcmb_3000_prim_u--crust--conv/"
# "mcmb_3000_prim_u--fsp--conv/"
# "mcmb_3000_u----conv/"
# "mcmbc_3600_prim_u--ceb--conv/"
# "mcmbc_3600_prim_u--crust--conv/"
# "mcmbc_3600_prim_u--fsp--conv/"
# "mcmbc_3600_u----conv/"
# "mcmbc_3800_prim_u--ceb--conv/"
# "mcmbc_3800_prim_u--crust--conv/"
# "mcmbc_3800_prim_u--fsp--conv/"
# "mcmbc_3800_u----conv/"
# "mcmbc_4000_prim_u--ceb--conv/"
# "mcmbc_4000_prim_u--crust--conv/"
# "mcmbc_4000_prim_u--fsp--conv/"
# "mcmbc_4000_u----conv/"
# "muller_2600----conv/"
# "muller_2600_prim--ceb--conv/"
# "muller_2600_prim--crust--conv/"
# "muller_2600_prim--fsp--conv/"
# "muller_2800----conv/"
# "muller_2800_prim--ceb--conv/"
# "muller_2800_prim--crust--conv/"
# "muller_2800_prim--fsp--conv/"
# "muller_3000----conv/"
# "muller_3000_prim--ceb--conv/"
# "muller_3000_prim--crust--conv/"
# "muller_3000_prim--fsp--conv/"
# "PR_3--ceb--conv/"
# "PR_3--crust--conv/"
# "PR_3--fsp--conv/"
# "PR_4--ceb--conv/"
# "PR_4--crust--conv/"
# "PR_4--fsp--conv/"
# "PR_4_150--ceb--conv/"
# "PR_4_150--crust--conv/"
# "PR_4_150--fsp--conv/"
# "PR_5--ceb--conv/"
# "PR_5--crust--conv/"
# "PR_5--fsp--conv/"
# "PR_5_150--ceb--conv/"
# "PR_5_150--crust--conv/"
# "PR_5_150--fsp--conv/"
# "PR_6--ceb--conv/"
# "PR_6--crust--conv/"
# "PR_6--fsp--conv/"
# "PR_6_150--ceb--conv/"
# "PR_6_150--crust--conv/"
# "PR_6_150--fsp--conv/"
# "PR_8--ceb--conv/"
# "PR_8--crust--conv/"
# "PR_8--fsp--conv/"
# "primordial_3--ceb--conv/"
# "primordial_3--crust--conv/"
# "primordial_3--fsp--conv/"
# "primordial_4--ceb--conv/"
# "primordial_4--crust--conv/"
# "primordial_4--fsp--conv/"
# "primordial_5--ceb--conv/"
# "primordial_5--crust--conv/"
# "primordial_5--fsp--conv/"
# "primordial_6--ceb--conv/"
# "primordial_6--crust--conv/"
# "primordial_6--fsp--conv/"
# "primordial_8--ceb--conv/"
# "primordial_8--crust--conv/"
# "primordial_8--fsp--conv/"
# "tempVisc----conv/"
# "tempViscComp----conv/"
# "thermal----conv/"
# "thermal2----conv/"
# "visc2----conv/"
# "visc3----conv/"
# "visc4----conv/"
# "visc4_incomp----conv/"
# "visc5----conv/"
# "visc5_incomp----conv/"
# "visc6----conv/"
# "visc6_incomp----conv/"
# "visc7----conv/"
# "visc7_incomp----conv/"
#-------------------------------------adiabat
# "CMB2600----conv/"
# "CMB2600_scale----conv/"
# "CMB2800----conv/"
# "CMB2800_scale----conv/"
# "CMB3000----conv/"
# "CMB3000_scale----conv/"
# "CMB3200----conv/"
# "CMB3200_scale----conv/"
# "CMB3400----conv/"
# "CMB3400_scale----conv/"
# "106_scale----conv/"
# "107_scale----conv/"
# "108_scale----conv/"
# "thermal----conv/"
# "primordial_6--crust--conv/"
# "primordial_6--fsp--conv/"
# "primordial_6--ceb--conv/"
# "primordial_8--crust--conv/"
# "primordial_8--fsp--conv/"
# "primordial_8--ceb--conv/"
# "thermal2----conv/"
# "primordial_5--crust--conv/"
# "primordial_5--fsp--conv/"
# "primordial_5--ceb--conv/"
# "PR_6--crust--conv/"
# "PR_6--fsp--conv/"
# "PR_6--ceb--conv/"
# "PR_6--crust--conv/"
# "PR_6--fsp--conv/"
# "PR_6--ceb--conv/"
# "BB055--crust--conv/"
# "BB055--fsp--conv/"
# "BB055--ceb--conv/"
# "BB066--crust--conv/"
# "BB066--fsp--conv/"
# "BB066--ceb--conv/"
# "BB088--crust--conv/"
# "BB088--fsp--conv/"
# "BB088--ceb--conv/"
# "primordial_3--crust--conv/"
# "primordial_3--fsp--conv/"
# "primordial_3--ceb--conv/"
# "primordial_4--crust--conv/"
# "primordial_4--fsp--conv/"
# "primordial_4--ceb--conv/"
# "PR_3--crust--conv/"
# "PR_3--fsp--conv/"
# "PR_3--ceb--conv/"
# "PR_4--crust--conv/"
# "PR_4--fsp--conv/"
# "PR_4--ceb--conv/"
# "PR_5--crust--conv/"
# "PR_5--fsp--conv/"
# "PR_5--ceb--conv/"
# "icond005----conv/"
# "icond009----conv/"
# "tempVisc----conv/"
# "BB000----conv/"
# "BB022----conv/"
# "BB044----conv/"
# "visc4_incomp----conv/"
# "visc5_incomp----conv/"
# "visc6_incomp----conv/"
# "visc7_incomp----conv/"
# "BB033----conv/"
# "PR_4_150--crust--conv/"
# "PR_4_150--fsp--conv/"
# "PR_4_150--ceb--conv/"
# "PR_4_150--crust--conv/"
# "PR_4_150--fsp--conv/"
# "PR_4_150--ceb--conv/"
# "PR_4_150--crust--conv/"
# "PR_4_150--fsp--conv/"
# "PR_4_150--ceb--conv/"
# "BB066_tvisc----conv/"
# "CMB2600_2----conv/"
# "CMB2600_2_tvisc----conv/"
# "CMB2600_2_prim--crust--conv/"
# "CMB2600_2_prim--fsp--conv/"
# "CMB2600_2_prim--ceb--conv/"
# "CMB2600_2_prim_tvisc--crust--conv/"
# "CMB2600_2_prim_tvisc--fsp--conv/"
# "CMB2600_2_prim_tvisc--ceb--conv/"
# "CMB2800_2----conv/"
# "CMB2800_2_tvisc----conv/"
# "CMB2800_2_prim--crust--conv/"
# "CMB2800_2_prim--fsp--conv/"
# "CMB2800_2_prim--ceb--conv/"
# "CMB2800_2_prim_tvisc--crust--conv/"
# "CMB2800_2_prim_tvisc--fsp--conv/"
# "CMB2800_2_prim_tvisc--ceb--conv/"
# "CMB3000_2----conv/"
# "CMB2800_2_tvisc----conv/"
# "CMB3000_2_prim--crust--conv/"
# "CMB3000_2_prim--fsp--conv/"
# "CMB3000_2_prim--ceb--conv/"
# "CMB3000_2_prim_tvisc--crust--conv/"
# "CMB3000_2_prim_tvisc--fsp--conv/"
# "CMB3000_2_prim_tvisc--ceb--conv/"
# "CC_highT----conv/"
# "CC_highT_prim--crust--conv/"
# "CC_highT_prim--fsp--conv/"
# "CC_highT_prim--ceb--conv/"
# "CC----conv/"
# "CC_prim--crust--conv/"
# "CC_prim--fsp--conv/"
# "CC_prim--ceb--conv/"
# "CC_lowT----conv/"
# "CC_lowT_prim--crust--conv/"
# "CC_lowT_prim--fsp--conv/"
# "CC_lowT_prim--ceb--conv/"
# "muller_3000----conv/"
# "muller_3000_prim--crust--conv/"
# "muller_3000_prim--fsp--conv/"
# "muller_3000_prim--ceb--conv/"
# "muller_2600----conv/"
# "muller_2600_prim--crust--conv/"
# "muller_2600_prim--fsp--conv/"
# "muller_2600_prim--ceb--conv/"
# "muller_2800----conv/"
# "muller_2800_prim--crust--conv/"
# "muller_2800_prim--fsp--conv/"
# "muller_2800_prim--ceb--conv/"
# "m_visc1----conv/"
# "m_visc2----conv/"
# "m_visc3----conv/"
# "m_visc4----conv/"
# "m_bb_000----conv/"
# "m_bb_022----conv/"
# "m_bb_044----conv/"
# "m_bb_066----conv/"
# "m_bb_088----conv/"
# "m_visc1_tvisc----conv/"
# "m_visc2_tvisc----conv/"
# "m_visc3_tvisc----conv/"
# "m_visc4_tvisc----conv/"
# "m_bb_000_tvisc----conv/"
# "m_bb_022_tvisc----conv/"
# "m_bb_044_tvisc----conv/"
# "m_bb_066_tvisc----conv/"
# "m_bb_088_tvisc----conv/"
# "m_bb_022_tvisc----conv/"
# "m_bb_044_tvisc----conv/"
# "m_bb_066_tvisc----conv/"
# "m_bb_022_tvisc1_prim--crust--conv/"
# "m_bb_022_tvisc1_prim--fsp--conv/"
# "m_bb_022_tvisc1_prim--ceb--conv/"
# "m_bb_044_tvisc1_prim--crust--conv/"
# "m_bb_044_tvisc1_prim--fsp--conv/"
# "m_bb_044_tvisc1_prim--ceb--conv/"
# "m_bb_066_tvisc1_prim--crust--conv/"
# "m_bb_066_tvisc1_prim--fsp--conv/"
# "m_bb_066_tvisc1_prim--ceb--conv/"
# "m_precond_100----conv/"
# "m_precond_50----conv/"
# "m_thermal_het----conv/"
# "m_thermal_hom----conv/"
# "m_precond_100_rr----conv/"
# "m_jump_20----conv/"
# "m_jump_10----conv/"
# "m_viscav_2----conv/"
# "m_viscav_10----conv/"
# "mcmb_2600_u----conv/"
# "mcmb_2600_prim_u--crust--conv/"
# "mcmb_2600_prim_u--fsp--conv/"
# "mcmb_2600_prim_u--ceb--conv/"
# "mcmb_2800_u----conv/"
# "mcmb_2800_prim_u--crust--conv/"
# "mcmb_2800_prim_u--fsp--conv/"
# "mcmb_2800_prim_u--ceb--conv/"
# "mcmb_3000_u----conv/"
# "mcmb_3000_prim_u--crust--conv/"
# "mcmb_3000_prim_u--fsp--conv/"
# "mcmb_3000_prim_u--ceb--conv/"
# "m_lhz----conv/"
# "m_bas----conv/"
# "u_recy0----conv/"
# "u_recy1----conv/"
# "u_recy2----conv/"
# "u_recy3----conv/"
# "u_recy4----conv/"
# "u_recy5----conv/"
# "m_ave_c1----conv/"
# "m_ave_c2----conv/"
# "v1----conv/"
# "v2----conv/"
# "v3----conv/"
# "v4----conv/"
# "v6----conv/"
# "v7----conv/"
# "v8----conv/"
# "v9----conv/"
# "v10----conv/"
# "m3400_at----conv/"
# "m3400_at_prim--crust--conv/"
# "m3400_at_prim--fsp--conv/"
# "m3400_at_prim--ceb--conv/"
# "m3600_at----conv/"
# "m3600_at_prim--crust--conv/"
# "m3600_at_prim--fsp--conv/"
# "m3600_at_prim--ceb--conv/"
# "m3800_at----conv/"
# "m3800_at_prim--crust--conv/"
# "m3800_at_prim--fsp--conv/"
# "m3800_at_prim--ceb--conv/"
# "m4000_at----conv/"
# "m4000_at_prim--crust--conv/"
# "m4000_at_prim--fsp--conv/"
# "m4000_at_prim--ceb--conv/"
# "m4200_at----conv/"
# "m4200_at_prim--crust--conv/"
# "m4200_at_prim--fsp--conv/"
# "m4200_at_prim--ceb--conv/"
# "m3400_rh----conv/"
# "m3400_rh_prim--crust--conv/"
# "m3400_rh_prim--fsp--conv/"
# "m3400_rh_prim--ceb--conv/"
# "m4200_rh----conv/"
# "m3400_rh_at----conv/"
# "m3400_rh_at_prim--crust--conv/"
# "m3400_rh_at_prim--fsp--conv/"
# "m3400_rh_at_prim--ceb--conv/"
# "m4200_rh_at_prim--crust--conv/"
# "m4200_rh_at_prim--fsp--conv/"
# "m4200_rh_at_prim--ceb--conv/"
# "incompressible_400----conv/"
# "256_044_cc----conv/"
# "256_044_4000_1----conv/"
# "256_044_3800_lith_scl----conv/"
# "256_044_3800_lith_scl_1----conv/"
# ------- for selected models with overtones --------------
"m_cc_022_u----conv/"
"m_cc_022_u_prim--ceb--conv/"
"m_cc_022_u_prim--crust--conv/"
"m_cc_022_u_prim--fsp--conv/"
"m_cc_044_u----conv/"
"m_cc_044_u_prim--ceb--conv/"
"m_cc_044_u_prim--crust--conv/"
"m_cc_044_u_prim--fsp--conv/"
"m_cc_066_u----conv/"
"m_cc_066_u_prim--ceb--conv/"
"m_cc_066_u_prim--crust--conv/"
"m_cc_066_u_prim--fsp--conv/"
"m_022_tv1_prim_u--ceb--conv/"
"m_022_tv1_prim_u--crust--conv/"
"m_022_tv1_prim_u--fsp--conv/"
"m_022_tv1_u----conv/"
"m_044_tv1_prim_u--ceb--conv/"
"m_044_tv1_prim_u--crust--conv/"
"m_044_tv1_prim_u--fsp--conv/"
"m_044_tv1_u----conv/"
"m_066_tv1_prim_u--ceb--conv/"
"m_066_tv1_prim_u--crust--conv/"
"m_066_tv1_prim_u--fsp--conv/"
"m_066_tv1_u----conv/"
"visc2----conv/"
"visc3----conv/"
"visc4----conv/"
"visc5----conv/"
"visc6----conv/"
"visc7----conv/"
"mcmbc_3600_prim_u--ceb--conv/"
"mcmbc_3600_prim_u--crust--conv/"
"mcmbc_3600_prim_u--fsp--conv/"
"mcmbc_3600_u----conv/"
"mcmbc_3800_prim_u--ceb--conv/"
"mcmbc_3800_prim_u--crust--conv/"
"mcmbc_3800_prim_u--fsp--conv/"
"mcmbc_3800_u----conv/"
"mcmbc_4000_prim_u--ceb--conv/"
"mcmbc_4000_prim_u--crust--conv/"
"mcmbc_4000_prim_u--fsp--conv/"
"mcmbc_4000_u----conv/"
 )

XYZINFILE="xyzinfile"

# Array of modes to process
# modes=(
#     "0S198_50.9849" "0S112_87.9847" "0S127_78.1786" "0S144_69.3657"
#     "0S161_62.3103" "0S179_56.2370" "0S216_46.8415" "0S235_43.1459"
#     "0S271_37.5560" "0S253_40.1526" "0S28_275.5512" "0S35_234.9498"
#     "0S43_201.1721" "0S51_175.6817" "0S61_151.4316" "0S72_131.2899"
#     "0S84_114.5240" "0S98_99.5632")


#/media/will/WS/
# modes=(
#     "1S139_56.1706" "1S123_62.2891" "1S108_69.3597" "1S94_77.5747"
#     "1S80_88.0305" "1S68_99.6499" "1S57_113.7186" "1S47_131.3790"
#     "1S39_151.4894" "1S33_172.5188" "1S27_201.7951" "1S22_236.1617"
#     "1S18_274.3537")

# #/media/will/Monika/overtone_preds/
# modes=("2S200_37.5816" "2S184_40.2026" "2S168_43.2429"
#      "2S152_46.8327" "2S136_51.1429" "2S120_56.3928" "2S105_62.4333"
#      "2S91_69.4054" "2S78_77.6182" "2S66_87.7129" "2S56_99.2585"
#      "2S47_113.5513" "2S39_131.1820")

# #/media/will/Monika/overtone_preds/
# modes=("3S184_37.5203" "3S168_40.2040" "3S152_43.2641" "3S136_46.8088"
#      "3S120_51.0588" "3S105_56.0889" "3S91_62.3075" "3S79_69.3797"
#      "3S68_77.7951")

# # #/media/will/Monika/overtone_preds/
modes=("4S167_37.4857" "4S152_40.1005" "4S137_43.1925"
     "4S123_46.7013" "4S109_51.0517" "4S96_56.0738")

# Loop through each directory
for dir in "${dirs[@]}"; do
    full_dir="${base_dir}${dir}"

    # Loop through each mode
    for mode in "${modes[@]}"; do
        # Extract the short mode name (e.g., "0S112" from "0S112_87.9076")
        short_mode="${mode%%_*}"  # Removes everything after the first underscore

        # Check if numeric part of mode needs zero padding (for 0S28 to 0S98)
        #mode_num=${short_mode#0S}  # Extract the numeric part of the mode
        #mode_num=${short_mode#1S}  # Extract the numeric part of the mode
        #mode_num=${short_mode#2S}  # Extract the numeric part of the mode
        #mode_num=${short_mode#3S}  # Extract the numeric part of the mode
        mode_num=${short_mode#4S}  # Extract the numeric part of the mode
        if [[ $mode_num -lt 100 ]]; then
            # Pad with zeros to make it three digits
            padded_mode_num=$(printf "%03d" $mode_num)
            #short_mode="0S${padded_mode_num}"
            #short_mode="1S${padded_mode_num}"
            #short_mode="2S${padded_mode_num}"
            #short_mode="3S${padded_mode_num}"
            short_mode="4S${padded_mode_num}"
        fi

        # Construct the input file path
        infile="${full_dir}mode_${mode}_dc_CORRECT_COORDS_v3.txt"
        
        # Construct the output file name for the third column, using short_mode, without .txt extension
        outfile="${full_dir}${short_mode}_CCv3" 

        # Extract only the third column and save it to the outfile
        awk '{print $3}' "$infile" > "$outfile"

        echo "Processing file: $outfile"

        # Use the outfile with the expand command
        # Make sure to adjust the path to the expand command as necessary
        #build/bin/expand "$outfile" -lmax 40
        build/bin/expand "$outfile" -lmax 20

        #echo ${outfile}.sph2 > ${XYZINFILE}
        #echo ${outfile}_testing.xyz >> ${XYZINFILE}
        #echo 2 >> ${XYZINFILE} 		    #dc contour level
        #echo 0.01 >> ${XYZINFILE}	     #1=*100, 0.01=not
        #echo 1 $LMAX >> ${XYZINFILE}
        #echo 2 >> ${XYZINFILE}

        #build/bin/raw2xyz_jr < ${XYZINFILE}
        
    done
done

echo "All files processed".
